(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5559b6d9"],{2909:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));n("277d");var i=n("6b75");function r(e){if(Array.isArray(e))return Object(i["a"])(e)}n("a4d3"),n("e01a"),n("d28b"),n("a630"),n("e260"),n("d3b7"),n("3ca3"),n("ddb0");function a(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}var s=n("06c5");function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e){return r(e)||a(e)||Object(s["a"])(e)||o()}},"30c7":function(e,t,n){"use strict";var i=n("ed6d"),r=n.n(i);r.a},4795:function(e,t,n){var i=n("23e7"),r=n("da84"),a=n("342f"),s=[].slice,o=/MSIE .\./.test(a),c=function(e){return function(t,n){var i=arguments.length>2,r=i?s.call(arguments,2):void 0;return e(i?function(){("function"==typeof t?t:Function(t)).apply(this,r)}:t,n)}};i({global:!0,bind:!0,forced:o},{setTimeout:c(r.setTimeout),setInterval:c(r.setInterval)})},"4de4":function(e,t,n){"use strict";var i=n("23e7"),r=n("b727").filter,a=n("1dde"),s=n("ae40"),o=a("filter"),c=s("filter");i({target:"Array",proto:!0,forced:!o||!c},{filter:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}})},6609:function(e,t,n){"use strict";n.r(t);var i={};n.r(i),n.d(i,"horizontalGroup",(function(){return u})),n.d(i,"verticalGroup",(function(){return l})),n.d(i,"obliquelyGroup",(function(){return d}));var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"TicTacToe"},[n("div",{staticClass:"stat"},[n("div",{staticClass:"title"},[e._v(" Победы в состязаниях: X "),n("span",[e._v(e._s(e.victories.X))]),e._v(" ˑ O "),n("span",[e._v(e._s(e.victories.O))])]),n("div",{staticClass:"description"},[e._v(" Количество тренировок и состязаний: "+e._s(e.trainingGames+e.duelGames)+" ")]),n("div",{staticClass:"timer"},[e._v(" Время обучения в секундах: "+e._s(e.timer)+" ")])]),n("div",{staticClass:"fields"},e._l(e.agents.X.concat(e.agents.O),(function(t,i){return n("div",{key:i,staticClass:"field"},[e._l(t.field,(function(r,a){return n("div",{key:i+":"+a,class:["cell",{sign:r,alive:t.isAlive,victory:t.isVictory}],on:{click:function(n){return e.setSign(t,a)}}},[e._v(" "+e._s(r)+" ")])})),n("div",{staticClass:"caption"},[e._v(" Поле игрока: "+e._s(t.sign)+" ")])],2)})),0),n("div",{staticClass:"duel-field"},[e._l(e.duel.field,(function(t,i){return n("div",{key:i,class:["cell",t,{victory:e.victoriesStatus[t]}]},[e._v(" "+e._s(t)+" ")])})),n("div",{staticClass:"caption"},[e._v(" Поле для состязаний ")])],2),e._m(0),n("div",{staticClass:"ai-vs-human-container"},[n("div",{staticClass:"caption"},[e._v(" Человек против AI ")]),n("div",{staticClass:"field"},e._l(e.AIvsHuman.field,(function(t,i){return n("div",{key:i,class:["cell",{victory:e.victoriesStatus[t]}],on:{click:function(t){return e.setHumanSign(i)}}},[e._v(" "+e._s(t)+" ")])})),0)])])},a=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"fields-description"},[n("div",[e._v("Первая игра - игроки на своих полях, вторая игра - состязание.")]),n("div",[e._v("Подсветка золотистым - победа. Цель обучения - сводить игру в ничью.")])])}],s=(n("99af"),n("4de4"),n("4160"),n("c975"),n("d81d"),n("a434"),n("d3b7"),n("3ca3"),n("159b"),n("ddb0"),n("4795"),n("2909")),o=(n("96cf"),n("1da1")),c=n("ce1a");function u(e){for(var t=e.field,n=e.sign,i=0,r=0;r<t.length;r++){if(t[r]===n)i+=1;else{i=0;while(r%3+1!==3)r+=1}if(3===i)return!0}return!1}function l(e){for(var t=e.field,n=e.sign,i=e.start,r=e.step,a=0,s=0,o=i;o<t.length;o++){if(t[o]===n)a+=1,1===a&&(s=o),o+=r;else if(0!==a&&(o=s),a=0,2===o)break;if(3===a)return!0}return!1}function d(e){var t=e.field,n=e.sign;return l({field:t,sign:n,start:0,step:3})||l({field:t,sign:n,start:2,step:1})}var f=!0,m=!1,v={name:"TicTacToe",data:function(){return{modelX:c["b"](),modelO:c["b"](),trainingCount:{X:0,O:0},training:{X:{inputs:[],labels:[]},O:{inputs:[],labels:[]}},agents:{X:[],O:[]},victories:{X:0,O:0},victoriesStatus:{X:!1,O:!1},fieldSize:9,step:1,trainingGames:1,isDuel:!1,duel:{step:1,field:["","","","","","","","",""]},duelGames:1,timerStart:0,timer:0,AIvsHuman:{step:1,rewards:[.1,.1,.1,.1,.1,.1,.1,.1,.1],field:["","","","","","","","",""]}}},mounted:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.setupModel({model:e.modelX}),e.setupModel({model:e.modelO}),e.agentsSetting({sign:"X"}),e.agentsSetting({sign:"O"}),f&&e.gameLoop(),e.timerStart=performance.now(),e.setTimer();case 7:case"end":return t.stop()}}),t)})))()},methods:{setupModel:function(e){var t=e.model;t.add(c["a"].dense({inputShape:[this.fieldSize+1],activation:"sigmoid",units:32})),t.add(c["a"].dense({activation:"sigmoid",units:24})),t.add(c["a"].dense({activation:"sigmoid",units:this.fieldSize})),t.compile({optimizer:"adam",loss:"meanSquaredError"})},agentsSetting:function(e){var t=e.sign;this.agents[t]=[{sign:t,isAlive:!0,isVictory:!1,rewards:[.1,.1,.1,.1,.1,.1,.1,.1,.1],field:["","","","","","","","",""]}]},gameLoop:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.isDuel){t.next=6;break}return t.next=3,e.startDuel();case 3:e.duelGames+=1,t.next=10;break;case 6:return e.isDuel=e.trainingGames%e.fieldSize===0,e.trainingGames+=1,t.next=10,e.startTraining();case 10:if(!m){t.next=13;break}return t.next=13,new Promise((function(e){return setTimeout(e,100)}));case 13:e.gameLoop();case 14:case"end":return t.stop()}}),t)})))()},startDuel:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(t){var n=e.agents.X.filter((function(e){var t=e.isAlive;return t})),i=n.length;n.length>0?n.forEach(function(){var n=Object(o["a"])(regeneratorRuntime.mark((function n(r){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.modelPredict({model:e.modelX,agent:r});case 2:i-=1,0===i&&t();case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()):t()}));case 2:return t.next=4,new Promise((function(t){var n=e.agents.O.filter((function(e){var t=e.isAlive;return t})),i=n.length;n.length>0?n.forEach(function(){var n=Object(o["a"])(regeneratorRuntime.mark((function n(r){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.modelPredict({model:e.modelO,agent:r});case 2:i-=1,0===i&&t();case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()):t()}));case 4:if(e.duel.step!==e.fieldSize){t.next=11;break}return t.next=7,Promise.all([e.modelFit({model:e.modelX,sign:"X"}),e.modelFit({model:e.modelO,sign:"O"})]);case 7:e.isDuel=!1,e.duel={step:1,field:["","","","","","","","",""]},t.next=12;break;case 11:e.duel.step+=1;case 12:case"end":return t.stop()}}),t)})))()},startTraining:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(e.agents.X.filter((function(e){var t=e.isAlive;return t})).map((function(t){return e.modelPredict({model:e.modelX,agent:t})})).concat(e.agents.O.filter((function(e){var t=e.isAlive;return t})).map((function(t){return e.modelPredict({model:e.modelO,agent:t})}))));case 2:if(e.step!==e.fieldSize){t.next=8;break}return t.next=5,Promise.all([e.modelFit({model:e.modelX,sign:"X"}),e.modelFit({model:e.modelO,sign:"O"})]);case 5:e.step=1,t.next=9;break;case 8:e.step+=1;case 9:case"end":return t.stop()}}),t)})))()},modelPredict:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var i,r,a,o,u,l,d,f,m;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i=e.model,r=e.agent,a=t.isDuel?t.duel.step:t.step,o=a<=3?a/3:1-a/t.fieldSize,n.next=5,i.predict(c["c"]([r.rewards.concat([o])])).data();case 5:u=n.sent,l=u.indexOf(Math.max.apply(Math,Object(s["a"])(u))),d=r.sign,f=t.isDuel?t.duel.field:r.field,0===f[l].length?(f.splice(l,1,d),r.rewards=r.rewards.map((function(e){return e+.1})),m=t.determineWinner({field:f,sign:d}),m?(r.isAlive=!1,r.isVictory=!0,r.rewards[l]=.99,t.saveTraining({input:f.map((function(e){return e===d?.9:.1})).concat([o]),label:r.rewards,sign:d}),t.isDuel&&(t.victories[d]+=1,t.victoriesStatus[d]=!0)):(r.rewards[l]=.5,t.saveTraining({input:f.map((function(e){return e===d?.5:.05})).concat([o]),label:r.rewards,sign:d}))):(r.isAlive=!1,r.rewards[l]=.01,t.saveTraining({input:f.map((function(e){return 0===e.length?.05:.01})).concat([o]),label:r.rewards,sign:d}));case 10:case"end":return n.stop()}}),n)})))()},determineWinner:function(e){var t=e.field,n=e.sign;return i.horizontalGroup({field:t,sign:n})||i.verticalGroup({field:t,sign:n,start:0,step:2})||i.obliquelyGroup({field:t,sign:n})},saveTraining:function(e){var t=e.input,n=e.label,i=e.sign;this.training[i].inputs.push(t),this.training[i].labels.push(n),this.trainingCount[i]+=1},modelFit:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var i,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(i=e.model,r=e.sign,!(t.trainingCount[r]>0)){n.next=10;break}return t.trainingCount[r]=0,t.victoriesStatus[r]=!1,n.next=6,i.fit(c["c"](t.training[r].inputs),c["c"](t.training[r].labels),{epochs:1});case 6:t.training[r].inputs=[],t.training[r].labels=[],t.agentsSetting({sign:"X"}),t.agentsSetting({sign:"O"});case 10:case"end":return n.stop()}}),n)})))()},setSign:function(e,t){var n=e.sign;if(!f&&0===e.field[t].length){e.field.splice(t,1,n),e.rewards=e.rewards.map((function(e){return e+.1}));var r=i.horizontalGroup({field:e.field,sign:n})||i.verticalGroup({field:e.field,sign:n,start:0,step:2})||i.obliquelyGroup({field:e.field,sign:n});r&&(e.isAlive=!1,e.isVictory=!0),console.log("isWinner",r)}},setTimer:function(){setTimeout(this.setTimer,1e3),this.timer=Math.round((performance.now()-this.timerStart)/1e3)},setHumanSign:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var i,r,a,o,u,l,d,f;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return i=t.AIvsHuman,r=i.field,a=i.step,0===r[e].length&&(r.splice(e,1,"X"),t.AIvsHuman.rewards=t.AIvsHuman.rewards.map((function(e){return e+.1})),o=t.determineWinner({field:r,sign:"X"}),console.log("isHumanWinner",o),t.AIvsHuman.step+=1),u=a<=3?a/3:1-a/t.fieldSize,n.next=5,t.modelO.predict(c["c"]([t.AIvsHuman.rewards.concat([u])])).data();case 5:l=n.sent,d=l.indexOf(Math.max.apply(Math,Object(s["a"])(l))),0===r[d].length&&(r.splice(d,1,"O"),t.AIvsHuman.rewards=t.AIvsHuman.rewards.map((function(e){return e+.1})),f=t.determineWinner({field:r,sign:"O"}),console.log("isAIWinner",f));case 8:case"end":return n.stop()}}),n)})))()}}},g=v,p=(n("30c7"),n("2877")),h=Object(p["a"])(g,r,a,!1,null,"f07cef10",null);t["default"]=h.exports},"99af":function(e,t,n){"use strict";var i=n("23e7"),r=n("d039"),a=n("e8b5"),s=n("861d"),o=n("7b0b"),c=n("50c4"),u=n("8418"),l=n("65f0"),d=n("1dde"),f=n("b622"),m=n("2d00"),v=f("isConcatSpreadable"),g=9007199254740991,p="Maximum allowed index exceeded",h=m>=51||!r((function(){var e=[];return e[v]=!1,e.concat()[0]!==e})),b=d("concat"),w=function(e){if(!s(e))return!1;var t=e[v];return void 0!==t?!!t:a(e)},O=!h||!b;i({target:"Array",proto:!0,forced:O},{concat:function(e){var t,n,i,r,a,s=o(this),d=l(s,0),f=0;for(t=-1,i=arguments.length;t<i;t++)if(a=-1===t?s:arguments[t],w(a)){if(r=c(a.length),f+r>g)throw TypeError(p);for(n=0;n<r;n++,f++)n in a&&u(d,f,a[n])}else{if(f>=g)throw TypeError(p);u(d,f++,a)}return d.length=f,d}})},a434:function(e,t,n){"use strict";var i=n("23e7"),r=n("23cb"),a=n("a691"),s=n("50c4"),o=n("7b0b"),c=n("65f0"),u=n("8418"),l=n("1dde"),d=n("ae40"),f=l("splice"),m=d("splice",{ACCESSORS:!0,0:0,1:2}),v=Math.max,g=Math.min,p=9007199254740991,h="Maximum allowed length exceeded";i({target:"Array",proto:!0,forced:!f||!m},{splice:function(e,t){var n,i,l,d,f,m,b=o(this),w=s(b.length),O=r(e,w),x=arguments.length;if(0===x?n=i=0:1===x?(n=0,i=w-O):(n=x-2,i=g(v(a(t),0),w-O)),w+n-i>p)throw TypeError(h);for(l=c(b,i),d=0;d<i;d++)f=O+d,f in b&&u(l,d,b[f]);if(l.length=i,n<i){for(d=O;d<w-i;d++)f=d+i,m=d+n,f in b?b[m]=b[f]:delete b[m];for(d=w;d>w-i+n;d--)delete b[d-1]}else if(n>i)for(d=w-i;d>O;d--)f=d+i-1,m=d+n-1,f in b?b[m]=b[f]:delete b[m];for(d=0;d<n;d++)b[d+O]=arguments[d+2];return b.length=w-i+n,l}})},c975:function(e,t,n){"use strict";var i=n("23e7"),r=n("4d64").indexOf,a=n("a640"),s=n("ae40"),o=[].indexOf,c=!!o&&1/[1].indexOf(1,-0)<0,u=a("indexOf"),l=s("indexOf",{ACCESSORS:!0,1:0});i({target:"Array",proto:!0,forced:c||!u||!l},{indexOf:function(e){return c?o.apply(this,arguments)||0:r(this,e,arguments.length>1?arguments[1]:void 0)}})},ed6d:function(e,t,n){}}]);
//# sourceMappingURL=chunk-5559b6d9.f38553f6.js.map