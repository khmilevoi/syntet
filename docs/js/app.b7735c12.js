(function(e){function t(t){for(var i,s,u=t[0],o=t[1],l=t[2],f=0,h=[];f<u.length;f++)s=u[f],r[s]&&h.push(r[s][0]),r[s]=0;for(i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i]);c&&c(t);while(h.length)h.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],i=!0,u=1;u<n.length;u++){var o=n[u];0!==r[o]&&(i=!1)}i&&(a.splice(t--,1),e=s(s.s=n[0]))}return e}var i={},r={app:0},a=[];function s(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=i,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(n,i,function(t){return e[t]}.bind(null,i));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var u=window["webpackJsonp"]=window["webpackJsonp"]||[],o=u.push.bind(u);u.push=t,u=u.slice();for(var l=0;l<u.length;l++)t(u[l]);var c=o;a.push([1,"chunk-vendors"]),n()})({0:function(e,t){},1:function(e,t,n){e.exports=n("56d7")},2:function(e,t){},"2c50":function(e,t,n){"use strict";var i=n("a67a"),r=n.n(i);r.a},3:function(e,t){},4:function(e,t){},5:function(e,t){},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("f751"),n("097d");var i=n("2b0e"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"stat"},[e._v("\n    Живых: "+e._s(e.alives)+" | Поколений: "+e._s(e.generation)+" | Победы: "+e._s(e.victories)+"\n  ")]),n("div",{ref:"container",staticClass:"container",attrs:{tabindex:"0"},on:{keyup:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"up",38,t.key,["Up","ArrowUp"])?null:e.handleJumpTop(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"right",39,t.key,["Right","ArrowRight"])?null:"button"in t&&2!==t.button?null:e.handleJumpRight(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"down",40,t.key,["Down","ArrowDown"])?null:e.handleJumpBottom(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"left",37,t.key,["Left","ArrowLeft"])?null:"button"in t&&0!==t.button?null:e.handleJumpLeft(t)}]}},[n("div",{staticClass:"field cells"},e._l(e.field,function(t,i){return n("div",{key:i,class:["cell",{available:0!==t}]},[1===t?n("div",{staticClass:"starting-checkpoint"},[e._v("\n          🥾\n        ")]):e._e(),t===e.investigatedMaximumCellValue||e.investigatedMaximumCellValue===e.maximumCellValue?n("div",{staticClass:"maximum-cell-value-checkpoint"},[e._v("\n          🤘\n        ")]):e._e(),t===e.maximumCellValue?n("div",{staticClass:"finishing-checkpoint"},[e._v("\n          🧠\n        ")]):e._e()])}),0),e.isDisplayingActors?n("div",{staticClass:"field actors"},e._l(e.actors,function(t){return n("div",{key:t.id,style:{gridRow:t.y,gridColumn:t.x}},[n("div",{ref:"actors_"+t.id,refInFor:!0,staticClass:"actor"},[n("div",[e._v("👣️")])])])}),0):e._e()])])},a=[],s=(n("6d67"),n("5df3"),n("768b")),u=(n("ac6a"),n("f3e2"),n("75fc")),o=(n("96cf"),n("3b8d")),l=n("0b53"),c=!0,f=!0,h=500,d=5,p=h/d,m=0,v={name:"Square",data:function(){return{model:l["b"](),training:{inputs:[],labels:[]},learning:{inputs:[],labels:[]},generation:0,victories:0,isDisplayingActors:f,actors:[],alives:h,investigatedMaximumCellValue:1,field:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,45,44,43,0,0,2,0,0,0,0,0,0,0,0,0,42,0,0,3,0,0,8,9,10,11,0,0,0,41,0,0,4,5,6,7,0,0,12,0,0,0,40,0,0,0,0,0,0,0,0,13,0,0,0,39,0,0,0,0,0,0,0,15,14,0,0,0,38,0,0,0,0,0,0,0,16,0,0,0,0,37,0,0,0,21,20,19,18,17,0,0,0,0,36,0,0,0,22,0,0,0,0,0,0,33,34,35,0,0,0,23,0,0,0,0,0,0,32,0,0,0,0,0,24,25,26,27,28,29,30,31,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],fieldSize:-1,maximumCellValue:-1}},mounted:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.setupModel(),this.fieldSetting(),e.next=4,this.actorsSetting();case 4:if(!c){e.next=7;break}return e.next=7,this.modelPredict();case 7:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),methods:{setupModel:function(){this.model.add(l["a"].dense({inputShape:[3],activation:"sigmoid",units:256})),this.model.add(l["a"].dropout({rate:.1})),this.model.add(l["a"].dense({activation:"sigmoid",units:128})),this.model.add(l["a"].dense({activation:"sigmoid",units:4})),this.model.compile({optimizer:l["d"].adam(.01),loss:"meanSquaredError",metrics:["accuracy"]})},fieldSetting:function(){this.fieldSize=Math.sqrt(this.field.length),this.maximumCellValue=Math.max.apply(Math,Object(u["a"])(this.field)),this.$refs.container.style.setProperty("--quantity-rows",this.fieldSize),this.$refs.container.style.setProperty("--quantity-columns",this.fieldSize)},actorsSetting:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:for(t=0;t<h;t++)this.actors.push({id:t,style:void 0,x:2,y:2,cellValue:1});if(!f){e.next=5;break}return e.next=4,this.$nextTick();case 4:this.actors.forEach(function(e){var t=Object(s["a"])(n.$refs["actors_".concat(e.id)],1),i=t[0].style;e.style=i});case 5:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),actorsReset:function(){for(var e=0;e<h;e++)this.actors[e].x=2,this.actors[e].y=2,this.actors[e].cellValue=1;this.alives=h},modelPredict:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.actors.map(function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(n){var i,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(0===n.cellValue){e.next=14;break}if(m+=1,m!==p){e.next=7;break}i=t.getRandomPredict(),m=0,e.next=10;break;case 7:return e.next=9,t.model.predict(l["c"]([[n.x/t.fieldSize,n.y/t.fieldSize,n.cellValue/t.maximumCellValue]])).data();case 9:i=e.sent;case 10:return r=t.getDirectionStep(i),t[r](n),e.next=14,t.availabilityCheck(n);case 14:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 2:return e.next=4,this.modelPredict();case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),getRandomPredict:function(){return[Math.random(),Math.random(),Math.random(),Math.random()]},getDirectionStep:function(e){var t=Object(s["a"])(e,4),n=t[0],i=t[1],r=t[2],a=t[3],u=n,o="jumpTop";return i>u&&(u=i,o="jumpRight"),r>u&&(u=r,o="jumpBottom"),a>u&&(o="jumpLeft"),o},jumpTop:function(e){e.y-=1},jumpRight:function(e){e.x+=1},jumpBottom:function(e){e.y+=1},jumpLeft:function(e){e.x-=1},availabilityCheck:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var n,i,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.y-1,i=t.x-1,r=this.field[n*this.fieldSize+i],!(r>t.cellValue)){e.next=13;break}if(t.cellValue=r,r>this.investigatedMaximumCellValue&&(this.investigatedMaximumCellValue=r),r!==this.maximumCellValue){e.next=11;break}return this.victories+=1,e.next=10,this.actorsReset();case 10:return e.abrupt("return");case 11:e.next=15;break;case 13:t.cellValue=0,this.alives-=1;case 15:if(this.saveTraining({actor:t,label:this.getAntennaCellValues({normalX:i,normalY:n})}),0!==this.alives){e.next=19;break}return e.next=19,this.modelFit();case 19:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),getAntennaCellValues:function(e){var t=e.normalX,n=e.normalY,i=this.field[(n-1)*this.fieldSize+t]||0,r=this.field[n*this.fieldSize+(t+1)]||0,a=this.field[(n+1)*this.fieldSize+t]||0,s=this.field[n*this.fieldSize+(t-1)]||0;return[i/this.maximumCellValue,r/this.maximumCellValue,a/this.maximumCellValue,s/this.maximumCellValue]},saveTraining:function(e){var t=e.actor,n=e.label;this.training.inputs.push([t.x/this.fieldSize,t.y/this.fieldSize,t.cellValue/this.maximumCellValue]),this.training.labels.push(n)},modelFit:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,n,i,r,a,s,u,o,c,f,h;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.getBestMoves(),n=t.firstInput,i=t.firstLabel,r=t.secondInput,a=t.secondLabel,s=t.thirdInput,u=t.thirdLabel,o=t.fourInput,c=t.fourLabel,f=t.fiveInput,h=t.fiveLabel,this.learning.inputs.push(n,r,s,o,f),this.learning.labels.push(i,a,u,c,h),e.next=5,this.model.fit(l["c"](this.learning.inputs),l["c"](this.learning.labels));case 5:return this.generation+=1,e.next=8,this.actorsReset();case 8:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),getBestMoves:function(){var e=this.training,t=e.inputs,n=e.labels;this.training={inputs:[],labels:[]};var i=-1,r=-1,a=-1,u=-1,o=-1,l=-1,c=-1,f=-1,h=-1,d=-1;return t.forEach(function(e,t){var n=Object(s["a"])(e,3),p=n[2];switch(!0){case p>o:i=r,r=a,a=u,u=o,o=p,l=c,c=f,f=h,h=d,d=t;break;case p>u:i=r,r=a,a=u,u=p,l=c,c=f,f=h,h=t;break;case p>a:i=r,r=a,a=p,l=c,c=f,f=t;break;case p>r:i=r,r=p,l=c,c=t;break;case p>i:i=p,l=t;break;default:}}),{firstInput:t[d],firstLabel:n[d],secondInput:t[h],secondLabel:n[h],thirdInput:t[f],thirdLabel:n[f],fourInput:t[c],fourLabel:n[c],fiveInput:t[l],fiveLabel:n[l]}},handleJumpTop:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=Object(s["a"])(this.actors,1),n=t[0],this.jumpTop(n),e.next=4,this.availabilityCheck(n);case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),handleJumpRight:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=Object(s["a"])(this.actors,1),n=t[0],this.jumpRight(n),e.next=4,this.availabilityCheck(n);case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),handleJumpBottom:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=Object(s["a"])(this.actors,1),n=t[0],this.jumpBottom(n),e.next=4,this.availabilityCheck(n);case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),handleJumpLeft:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=Object(s["a"])(this.actors,1),n=t[0],this.jumpLeft(n),e.next=4,this.availabilityCheck(n);case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()}},b=v,g=(n("2c50"),n("2877")),x=Object(g["a"])(b,r,a,!1,null,"69f9237b",null),y=x.exports;i["a"].config.productionTip=!1,i["a"].config.silent=!0,new i["a"]({render:function(e){return e(y)}}).$mount("#app")},6:function(e,t){},7:function(e,t){},8:function(e,t){},a67a:function(e,t,n){}});
//# sourceMappingURL=app.b7735c12.js.map